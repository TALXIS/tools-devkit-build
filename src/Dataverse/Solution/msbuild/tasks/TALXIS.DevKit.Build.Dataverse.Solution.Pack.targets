<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <!-- Pack settings -->
    <IsPackable>true</IsPackable>
    <IncludeBuildOutput>false</IncludeBuildOutput>
    <SuppressDependenciesWhenPacking>true</SuppressDependenciesWhenPacking>
    <NoPackageAnalysis>true</NoPackageAnalysis>
    <NugetPackageTypeValue>pp-solution</NugetPackageTypeValue>
    <GeneratePackageOnPublish>true</GeneratePackageOnPublish>
    <!-- Publish settings - no DLL output for Solution projects -->
    <IsPublishable>true</IsPublishable>
    <CopyBuildOutputToPublishDirectory>false</CopyBuildOutputToPublishDirectory>
    <CopyOutputSymbolsToPublishDirectory>false</CopyOutputSymbolsToPublishDirectory>
  </PropertyGroup>

  <Target Name="_IncludeSolutionZipInPack"
          BeforeTargets="_GetPackageFiles"
          DependsOnTargets="Build">
    <ItemGroup>
      <None Include="$(SolutionPackageZipFilePath)"
            Pack="true"
            PackagePath="content/solution/" />
      <None Include="$(MSBuildThisFileDirectory)TALXIS.DevKit.Build.Dataverse.Solution.Pack.consumer.props"
            Pack="true"
            PackagePath="build/$(PackageId).props" />
    </ItemGroup>
  </Target>

  <!-- Hook Pack into Publish (GeneratePackageOnPublish is not a standard SDK property) -->
  <Target Name="_PackAsPublishAfterTarget"
          AfterTargets="Publish"
          Condition="'$(GeneratePackageOnPublish)' == 'true'"
          DependsOnTargets="Pack">
  </Target>

</Project>
